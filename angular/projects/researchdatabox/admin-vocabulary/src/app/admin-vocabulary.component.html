<div class="container-fluid py-3" *ngIf="isReady">
  <div class="row align-items-end mb-3">
    <div class="col-md-8">
      <p class="text-uppercase text-muted small mb-1">Admin Console</p>
      <h2 class="mb-2">Vocabulary Management</h2>
      <p class="text-muted mb-0">Curate controlled lists, keep RVA imports in sync, and maintain entry order from one workspace.</p>
    </div>
    <div class="col-md-4 mt-3 mt-md-0">
      <div class="d-flex justify-content-md-end flex-wrap">
        <span class="badge badge-light mr-2 mb-2 p-2">Total: {{ totalVocabularies }}</span>
        <span class="badge badge-light mr-2 mb-2 p-2">Local: {{ localVocabularies }}</span>
        <span class="badge badge-light mb-2 p-2">RVA: {{ rvaVocabularies }}</span>
      </div>
    </div>
  </div>

  <div class="card mb-3">
    <div class="card-body d-flex justify-content-between align-items-center flex-wrap">
      <div class="btn-group mb-2 mb-md-0" role="group" aria-label="Vocabulary actions">
        <button class="btn btn-primary" type="button" (click)="newVocabulary()">Create Vocabulary</button>
        <button class="btn btn-outline-primary" type="button" (click)="showImport()">Import RVA</button>
      </div>
      <small class="text-muted">Select a row to edit in a modal.</small>
    </div>
  </div>

  <div *ngIf="message" class="alert alert-success" role="status">{{ message }}</div>
  <div *ngIf="error" class="alert alert-danger" role="alert">{{ error }}</div>

  <vocab-list
    [vocabularies]="vocabularies"
    [selectedId]="selectedVocabulary?.id || null"
    (selected)="openVocabulary($event)"
    (deleted)="deleteVocabulary($event)"
  ></vocab-list>
</div>

<div class="modal fade show d-block" tabindex="-1" role="dialog" *ngIf="isEditModalOpen">
  <div class="modal-dialog modal-xl modal-dialog-scrollable" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ selectedVocabulary?.id ? 'Edit Vocabulary' : 'Create Vocabulary' }}</h5>
        <button type="button" class="close" aria-label="Close" (click)="closeEditModal()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <vocab-detail [draft]="draft" [selectedVocabularyId]="selectedVocabulary?.id || null"></vocab-detail>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" (click)="closeEditModal()">Cancel</button>
        <button type="button" class="btn btn-warning" (click)="syncSelected()" [disabled]="!canSyncSelected">Sync RVA</button>
        <button type="button" class="btn btn-success" (click)="save()" [disabled]="!canSave">Save</button>
      </div>
    </div>
  </div>
</div>
<div class="modal-backdrop fade show" *ngIf="isEditModalOpen"></div>

<div class="modal fade show d-block" tabindex="-1" role="dialog" *ngIf="isImportModalOpen">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Import RVA Vocabulary</h5>
        <button type="button" class="close" aria-label="Close" (click)="closeImportModal()">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <rva-import #importForm (importRequested)="importRva($event)"></rva-import>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" (click)="closeImportModal()">Cancel</button>
        <button type="button" class="btn btn-primary" (click)="importForm.runImport()" [disabled]="!importForm.canImport">Import</button>
      </div>
    </div>
  </div>
</div>
<div class="modal-backdrop fade show" *ngIf="isImportModalOpen"></div>
